{"version":3,"sources":["index.js"],"names":["api","isMac","navigator","platform","toUpperCase","indexOf","folderMimeType","folderImg","failOverImg","useStyles","makeStyles","theme","appBar","backgroundColor","lightBlue","icon","marginRight","spacing","grow","flexGrow","conditionGrow","Object","_Users_hht_WebstormProjects_GoogleDriveProxy_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_5__","breakpoints","up","search","position","borderRadius","shape","fade","palette","common","white","&:hover","marginLeft","width","searchIcon","height","pointerEvents","display","alignItems","justifyContent","inputRoot","color","inputInput","padding","transition","transitions","create","cardGrid","paddingTop","paddingBottom","card","flexDirection","cardMedia","cardContent","form","flexWrap","formControl","margin","minWidth","viewed","id","recentViews","JSON","parse","localStorage","getItem","splice","unshift","setItem","stringify","getRecents","addHistory","item","concat","_Users_hht_WebstormProjects_GoogleDriveProxy_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_4__","getHistory","popHistory","history","length","res","pop","getReadableFileSizeString","fileSizeInBytes","i","Math","max","toFixed","getToken","cacheItems","ReactDOM","render","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","classes","inputRef","React","createRef","iniHistory","_React$useState","useState","loggedIn","open","submitting","_React$useState2","_Users_hht_WebstormProjects_GoogleDriveProxy_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__","loginState","setLoginState","_React$useState3","_React$useState4","searchDisabled","setSearchDisabled","_React$useState5","_React$useState6","items","setItems","_React$useState7","_React$useState8","folders","setFolders","_React$useState9","_React$useState10","setHistory","_React$useState11","_React$useState12","favorites","setFavorites","_React$useState13","key","reverse","disabled","_React$useState14","orderby","setOrderby","_React$useState15","_React$useState16","view","setViewRaw","setView","obj","document","title","name","previous_state","URLSearchParams","set","hashEventResponder","e","params","window","location","hash","substr","queryParam","get","fileParam","newParams","type","push","loadResource","value","accessModal","replaceState","toString","cmpfnfn","b","c","k","localeCompare","parseInt","opts","fetch","_Users_hht_WebstormProjects_GoogleDriveProxy_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__","headers","Authorization","Content-Type","then","resp","json","sort","files","filter","el","mimeType","postProcess","catch","alert","finally","scrollTo","searchTrigger","ev","preventDefault","current","dispatchEvent","Event","state","find","x","body","method","console","log","loginTrigger","username","password","login","status","token","afterLogin","err","useEffect","addEventListener","updateFavorite","isAdd","includes","_ref","_Users_hht_WebstormProjects_GoogleDriveProxy_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_Users_hht_WebstormProjects_GoogleDriveProxy_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","mark","_callee","wrap","_context","prev","next","sent","errorMessage","stop","_x","apply","this","arguments","handleMenuClose","handleModalClick","mimetype","target","parentNode","attributes","getNamedItem","tagName","_React$useState17","_React$useState18","anchorEl","setAnchorEl","Fragment","_material_ui_core_CssBaseline__WEBPACK_IMPORTED_MODULE_9__","_material_ui_core_AppBar__WEBPACK_IMPORTED_MODULE_10__","className","_material_ui_core_Toolbar__WEBPACK_IMPORTED_MODULE_11__","_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_34__","aria-controls","aria-haspopup","onClick","event","currentTarget","_material_ui_icons__WEBPACK_IMPORTED_MODULE_12__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_25__","variant","_material_ui_core_Menu__WEBPACK_IMPORTED_MODULE_19__","keepMounted","Boolean","onClose","_material_ui_core_MenuItem__WEBPACK_IMPORTED_MODULE_35__","r","map","innerText","autoComplete","_material_ui_core_FormControl__WEBPACK_IMPORTED_MODULE_36__","_material_ui_core_InputLabel__WEBPACK_IMPORTED_MODULE_37__","htmlFor","_material_ui_core_Select__WEBPACK_IMPORTED_MODULE_38__","onChange","inputProps","removeItem","_material_ui_icons__WEBPACK_IMPORTED_MODULE_13__","action","onSubmit","_material_ui_core_InputBase__WEBPACK_IMPORTED_MODULE_24__","placeholder","root","input","aria-label","_material_ui_icons__WEBPACK_IMPORTED_MODULE_14__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_15__","_material_ui_core_LinearProgress__WEBPACK_IMPORTED_MODULE_33__","_material_ui_core_Container__WEBPACK_IMPORTED_MODULE_28__","maxWidth","_material_ui_core_Grid__WEBPACK_IMPORTED_MODULE_27__","container","xs","sm","md","_material_ui_core_Card__WEBPACK_IMPORTED_MODULE_29__","data-id","data-name","data-mimetype","style","time","modifiedTime","size","react_lazy_load_image_component__WEBPACK_IMPORTED_MODULE_45__","once","offset","cursor","src","thumbnailLink","_material_ui_core_CardMedia__WEBPACK_IMPORTED_MODULE_30__","image","tooltipCardMedia","top","right","_material_ui_icons__WEBPACK_IMPORTED_MODULE_16__","fill","_material_ui_icons__WEBPACK_IMPORTED_MODULE_17__","_material_ui_core_CardContent__WEBPACK_IMPORTED_MODULE_31__","_material_ui_core_Tooltip__WEBPACK_IMPORTED_MODULE_39__","placement","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_20__","_material_ui_core_CardActions__WEBPACK_IMPORTED_MODULE_32__","href","download","encodeURI","role","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_26__","delete","aria-labelledby","fullWidth","noWrap","_material_ui_icons__WEBPACK_IMPORTED_MODULE_18__","controls","autoPlay","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_40__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_42__","_material_ui_core_DialogContentText__WEBPACK_IMPORTED_MODULE_41__","_material_ui_core_TextField__WEBPACK_IMPORTED_MODULE_43__","autoFocus","required","label","onKeyPress","autoCapitalize","autoCorrect","evt","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_44__","left","getElementById"],"mappings":"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","file":"static/js/main.51d2e172.chunk.js","sourcesContent":["import React, {useEffect} from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport {Menu as MenuIcon, Search, ArrowBack, NavigateNext, CloudDownload, FavoriteBorder, Favorite} from '@material-ui/icons';\nimport Menu from '@material-ui/core/Menu';\nimport Typography from \"@material-ui/core/Typography\";\nimport {makeStyles} from \"@material-ui/core\";\nimport {lightBlue} from \"@material-ui/core/colors\";\nimport {fade} from \"@material-ui/core/styles\";\nimport InputBase from \"@material-ui/core/InputBase\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Container from \"@material-ui/core/Container\";\nimport Card from \"@material-ui/core/Card\";\nimport CardMedia from \"@material-ui/core/CardMedia\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport Select from \"@material-ui/core/Select\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport TextField from \"@material-ui/core/TextField\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\n\nconst api = \"https://api.sheltonhuang.me/GoogleDriveProxy/\";\n\nconst isMac = navigator.platform.toUpperCase().indexOf('MAC')>=0;\nconst folderMimeType = 'application/vnd.google-apps.folder';\nconst folderImg = 'folderImg.jpg';\nconst failOverImg = 'imgNotFound.jpg';\n\nconst useStyles = makeStyles(theme => ({\n    appBar: {\n        backgroundColor: lightBlue[\"700\"],\n    },\n    icon: {\n        marginRight: theme.spacing(2),\n    },\n    grow: {\n        flexGrow: 1,\n    },\n    conditionGrow: {\n        [theme.breakpoints.up('sm')]: {\n            flexGrow: 1,\n        }\n    },\n    search: {\n        position: 'relative',\n        borderRadius: theme.shape.borderRadius,\n        backgroundColor: fade(theme.palette.common.white, 0.15),\n        '&:hover': {\n            backgroundColor: fade(theme.palette.common.white, 0.25),\n        },\n        marginRight: 0,\n        marginLeft: 0,\n        width: '100%',\n        [theme.breakpoints.up('sm')]: {\n            width: 600,\n        },\n    },\n    searchIcon: {\n        width: theme.spacing(7),\n        height: '100%',\n        position: 'absolute',\n        pointerEvents: 'none',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n    },\n    inputRoot: {\n        color: 'inherit',\n        width: 'calc(100% - 50px)'\n    },\n    inputInput: {\n        padding: theme.spacing(1, 1, 1, 7),\n        transition: theme.transitions.create('width'),\n        width: '100%'\n    },\n    cardGrid: {\n        paddingTop: theme.spacing(8),\n        paddingBottom: theme.spacing(8),\n    },\n    card: {\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'column',\n    },\n    cardMedia: {\n        paddingTop: '56.25%', // 16:9\n    },\n    cardContent: {\n        flexGrow: 1,\n    },\n    form: {\n        display: 'flex',\n        flexWrap: 'wrap'\n    },\n    formControl: {\n        margin: theme.spacing(1),\n        minWidth: 120,\n    }\n}));\n\n\n\nconst viewed = (id) => {\n    let recentViews = JSON.parse(localStorage.getItem(\"recentViews\") || \"[]\");\n    let position = recentViews.indexOf(id);\n    if (position > -1) recentViews.splice(position, 1);\n    recentViews.unshift(id);\n    recentViews.splice(100);\n    localStorage.setItem(\"recentViews\", JSON.stringify(recentViews));\n};\n\nconst getRecents = () => JSON.parse(localStorage.getItem(\"recentViews\") || \"[]\");\nconst addHistory = (item) => localStorage.setItem(\"history\", JSON.stringify([...getHistory(), item]));\nconst popHistory = () => {\n    let history = getHistory();\n    if (history.length < 1) return null;\n    let res = history.pop();\n    localStorage.setItem(\"history\", JSON.stringify(history));\n    return res;\n};\nconst getHistory = () => JSON.parse(localStorage.getItem(\"history\") || \"[\\\"folder/root\\\"]\");\n\nfunction getReadableFileSizeString(fileSizeInBytes) {\n    let i = -1, byteUnits = [' kB', ' MB', ' GB', ' TB', 'PB', 'EB', 'ZB', 'YB'];\n    do { fileSizeInBytes = fileSizeInBytes / 1024; i++; } while (fileSizeInBytes > 1024);\n    return Math.max(fileSizeInBytes, 0.1).toFixed(1) + byteUnits[i];\n}\n\nconst getToken = ()=> localStorage.getItem(\"token\");\nlet cacheItems = [];\n\nfunction App() {\n    const classes = useStyles();\n    const inputRef = React.createRef();\n    const iniHistory = getHistory();\n\n    const [loginState, setLoginState]  = React.useState({loggedIn: !!getToken(), open: false, submitting: false});\n    const [searchDisabled, setSearchDisabled] = React.useState(!getToken());\n    const [items, setItems] = React.useState([]);\n    const [folders, setFolders] = React.useState([]);\n    const [history, setHistory] = React.useState(iniHistory);\n    const [favorites, setFavorites] = React.useState([]);\n    const [orderby, setOrderby] = React.useState({key: 'modifiedTime', reverse:true, disabled: false});\n    const [view, setViewRaw] = React.useState({open: false});\n    const setView = (obj) => {\n        document.title = obj.open ? obj.name : \"GoogleDriveProxy\";\n        setViewRaw(obj);\n    };\n\n    let previous_state =  new URLSearchParams();\n    if (iniHistory.length > 1) previous_state.set('q', iniHistory[iniHistory.length-1]);\n\n    const hashEventResponder = (e) => {\n        const params = new URLSearchParams(window.location.hash.substr(1));\n        const queryParam = params.get('q'), fileParam = params.get('f');\n        const newParams = new URLSearchParams();\n        newParams.set('q', queryParam ? queryParam : 'folder/root');\n        if (fileParam) newParams.set('f', fileParam);\n\n        if (previous_state.get('q') != newParams.get('q')) {\n            if (e && e.type != 'rewind') {\n                history.push(previous_state.get('q'));\n                addHistory(previous_state.get('q'));\n            }\n            loadResource({value: newParams.get('q')});\n        }\n\n        if (fileParam) {\n            accessModal({open: true, id: fileParam});\n        } else {\n            setView({open: false});\n        }\n        window.history.replaceState({}, '', '#' + newParams.toString());\n        previous_state = newParams;\n    };\n\n    const rewind = () => {\n        let params = new URLSearchParams(window.location.hash.substr(1));\n        params.set('q', history.pop());\n        popHistory();\n        window.history.replaceState({}, '', '#' + params.toString());\n        window.dispatchEvent(new Event(\"rewind\"));\n    };\n\n\n    const cmpfnfn = (a,b) => {\n        if (orderby.disabled) return 0;\n        if (orderby.reverse)  { let c = a; a = b; b = c; }\n        let k = orderby.key;\n        if (k === 'name' || k === 'modifiedTime') { return a[k].localeCompare(b[k]) }\n        else { return (a[k] && b[k]) ? parseInt(a[k]) - parseInt(b[k]) : a['modifiedTime'].localeCompare(b['modifiedTime']) }\n    };\n\n    const loadResource = (opts) => {\n        setSearchDisabled(true);\n        return fetch(`${api}${opts.value}`,  {headers: {Authorization: getToken(), 'Content-Type': 'application/json'}, ...(opts.opts ? opts.opts : {})})\n            .then(resp => resp.json())\n            .then((res) => {\n                setOrderby({...orderby, disabled: opts.sort === false});\n                setItems(cacheItems = res.files.filter(el => el.mimeType !== folderMimeType));\n                setFolders(res.files.filter(el => el.mimeType === folderMimeType));\n                return res;\n            })\n            .then((res) => opts.postProcess ? opts.postProcess(res) : null)\n            .catch(alert)\n            .finally(() => {\n                window.scrollTo(0, 0);\n                setSearchDisabled(false);\n            });\n    };\n\n    const searchTrigger = (ev) => {\n        ev && ev.preventDefault && ev.preventDefault();\n        let params = new URLSearchParams(window.location.hash.substr(1));\n        params.set('q', inputRef.current.value ? `query/${inputRef.current.value}` : 'folder/root');\n        window.history.replaceState({}, '', '#' + params.toString());\n        window.dispatchEvent(new Event(\"myhashchange\"));\n    };\n\n\n    const accessModal = (state) => {\n        if (state.name) {\n            setView(state);\n        } else {\n            let item = cacheItems.find(x => x.id === state.id);\n            if (item) {\n                setView({...state, name: item.name});\n                viewed(state.id);\n            } else {\n                fetch(`${api}file`, {\n                        body: JSON.stringify({files: [state.id]}),\n                        method: 'POST',\n                        headers: {'Authorization': getToken(), 'Content-Type': 'application/json'}\n                    })\n                    .then(resp => resp.json())\n                    .then(res => {\n                        if (res.files.length === 1) {\n                            setView({...state, name: res.files[0].name});\n                            viewed(state.id);\n                        }\n                    })\n                    .catch(console.log);\n            }\n        }\n    };\n\n    const loginTrigger = (ev) => {\n        if (ev.key === 'Enter' && loginState.username && loginState.password) login();\n    };\n\n    const login = () => {\n        setLoginState({...loginState, submitting: true});\n        fetch(`${api}auth`, {\n            body: JSON.stringify({username: loginState.username, password: loginState.password}),\n            method: 'POST',\n            headers: {'Content-Type': 'application/json'}\n        })\n            .then(resp => {\n                if (resp.status === 401) {\n                    alert(\"Incorrect username or password.\");\n                    throw resp;\n                } else if (resp.status === 200) {\n                    return resp.json();\n                } else {\n                    alert(\"Unknown response \" + resp.status + \" from server.\");\n                    throw resp;\n                }\n            })\n            .then(resp => {\n                localStorage.setItem('token', resp.token);\n                afterLogin();\n                setLoginState({loggedIn: true, open: false, submitting: false});\n            })\n            .catch(err => {\n                console.log(err);\n                setLoginState({...loginState, submitting: false});\n            })\n    };\n\n    const specialLogin = () => {\n        localStorage.setItem('token', loginState.password);\n        setLoginState({loggedIn: true, open: false, submitting: false});\n        afterLogin()\n    };\n\n    const logout = () => {\n        inputRef.current.value = \"\";\n        setLoginState({loggedIn: false, open: false, submitting: false});\n        setItems([]); setFolders([]); setFavorites([]); setHistory([]); setSearchDisabled(true);\n        localStorage.removeItem('token');\n        localStorage.removeItem('history');\n        handleMenuClose();\n    };\n\n    const afterLogin = () => {\n        hashEventResponder();\n        fetch(`${api}favorite`, {headers: {Authorization: getToken()}})\n            .then(resp => resp.json())\n            .then((res) => setFavorites(res.files))\n            .catch(alert);\n    };\n\n    useEffect(() => {\n        window.addEventListener(\"hashchange\", hashEventResponder, false);\n        window.addEventListener(\"myhashchange\", hashEventResponder, false);\n        window.addEventListener(\"rewind\", hashEventResponder, false);\n       if (getToken()) afterLogin();\n    // eslint-disable-next-line\n    }, []);\n\n\n    //modal\n\n    const updateFavorite = (id) => {\n        let isAdd = !favorites.includes(id);\n        fetch(`${api}favorite/${id}`, {headers: {Authorization: getToken()}, method: isAdd ? 'PUT' : 'DELETE'})\n            .then(async resp => {\n                if (resp.status === 204)  {\n                    if (isAdd) {\n                        if (!favorites.includes(id)) {\n                            setFavorites([id, ...favorites])\n                        }\n                    } else {\n                        setFavorites(favorites.filter(x => x !== id));\n                    }\n                } else if (resp.status === 507) {\n                    throw (await resp.json()).errorMessage;\n                } else {\n                    throw resp.json();\n                }\n            })\n            .catch(alert)\n            .finally(handleMenuClose);\n    };\n\n    const fetchRecent = () => {\n        let recentViews = getRecents();\n        if (recentViews.length) {\n            loadResource({\n                sort: false,\n                value: \"file\",\n                opts: {\n                    body: JSON.stringify({files: recentViews}),\n                    method: 'POST',\n                }}).then(handleMenuClose)\n        }\n    };\n\n    const changeReverse = (e) => {\n        if (e.target.innerText && e.target.innerText.includes('Order By')) {\n            setOrderby({...orderby, reverse: !orderby.reverse})\n        }\n    };\n\n    const handleModalClick = (e) => {\n        let el = e.target, id, name, mimetype;\n        do {\n            el = el.parentNode;\n            id = el.attributes.getNamedItem('data-id') ? el.attributes.getNamedItem('data-id').value : null;\n            name = el.attributes.getNamedItem('data-name') ? el.attributes.getNamedItem('data-name').value : null;\n            mimetype = el.attributes.getNamedItem('data-mimetype') ? el.attributes.getNamedItem('data-mimetype').value : null;\n        } while (el.parentNode && !(id && name && mimetype));\n\n        if (e.target.tagName === 'svg' || e.target.tagName === 'path') {  // is favorite click\n            updateFavorite(id);\n        } else {\n            let params = new URLSearchParams(window.location.hash.substr(1));\n            if (mimetype === folderMimeType) {\n                params.set('q', `folder/${id}`);\n                window.history.replaceState({}, '', '#' + params.toString());\n                window.dispatchEvent(new Event(\"myhashchange\"));\n            } else {\n                params.set('f', id);\n                window.history.replaceState({}, '', '#' + params.toString());\n                window.dispatchEvent(new Event(\"myhashchange\"));\n            }\n        }\n    };\n\n    const handleModalClose = () => {\n        let params = new URLSearchParams(window.location.hash.substr(1));\n        params.delete('f');\n        window.history.replaceState({}, '', '#' + params.toString());\n        window.dispatchEvent(new Event(\"myhashchange\"));\n    };\n\n\n    //menu\n    const [anchorEl, setAnchorEl] = React.useState(null);\n\n    const handleMenuClick = (event) => setAnchorEl(event.currentTarget);\n\n    const handleMenuClose = () => setAnchorEl(null);\n\n\n    function tooltipCardMedia(card) {\n        let time = card.modifiedTime;\n        let size = card.size;\n        if (time && size) {\n            return (<LazyLoadImage onClick={handleModalClick} once offset={600} style={{cursor: 'pointer'}}\n                   src={card.mimeType === folderMimeType ? folderImg : (card.thumbnailLink || failOverImg)} />)\n        } else {\n            return <CardMedia className={classes.cardMedia} title={card.name} onClick={handleModalClick} image={folderImg} />;\n        }\n    }\n\n\n    return (\n        <>\n            <CssBaseline />\n                <AppBar position=\"sticky\" className={classes.appBar}>\n                    <Toolbar>\n                        {loginState.loggedIn ?\n                            (<IconButton color=\"inherit\" aria-controls=\"simple-menu\" aria-haspopup=\"true\" onClick={handleMenuClick}><MenuIcon/></IconButton>) :\n                            ( <Button  variant=\"contained\"  onClick={() => setLoginState({...loginState, open: true})} >Login</Button>)\n                        }\n                        <Menu\n                            id=\"simple-menu\" keepMounted\n                            anchorEl={anchorEl}\n                            open={Boolean(anchorEl)}\n                            onClose={handleMenuClose}\n                        >\n                            <MenuItem onClick={() => {\n                                window.history.replaceState({}, '', '#');\n                                window.dispatchEvent(new Event(\"myhashchange\"));\n                            }} >Home</MenuItem>\n                            <MenuItem onClick={() => loadResource({\n                                value: \"favorite?alt=content\",\n                                postProcess: (r) => setFavorites(r.files.map(x => x.id)) })} >Favorites</MenuItem>\n                            <MenuItem onClick={changeReverse}>\n                                <form className={classes.form} autoComplete=\"off\">\n                                    <FormControl className={classes.formControl}>\n                                        <InputLabel htmlFor=\"orderby\">Order By{orderby.reverse ? ' ⬇️':' ⬆️'}</InputLabel>\n                                        <Select\n                                            value={orderby.key}\n                                            onChange={(event) => setOrderby({...orderby, key: event.target.value})}\n                                            inputProps={{ name: 'Order By', id: 'orderby', }}\n                                        >\n                                            <MenuItem value={'modifiedTime'}>Last Modified</MenuItem>\n                                            <MenuItem value={'name'}>Name</MenuItem>\n                                            <MenuItem value={'size'}>Size</MenuItem>\n                                        </Select>\n                                    </FormControl>\n                                </form>\n                            </MenuItem>\n                            <MenuItem onClick={fetchRecent} >Recently Viewed</MenuItem>\n                            <MenuItem onClick={logout} >Logout</MenuItem>\n                        </Menu>\n\n                        <div className={classes.grow} />\n                        <div className={classes.search}>\n                            <div className={classes.searchIcon}>\n                                <Search />\n                            </div>\n                            <form action=\".\" onSubmit={searchTrigger}>\n                                <InputBase\n                                    placeholder=\"Search…\"\n                                    classes={{\n                                        root: classes.inputRoot,\n                                        input: classes.inputInput,\n                                    }}\n                                    inputProps={{ 'aria-label': 'Search keywords' }}\n                                    inputRef={inputRef}\n                                    disabled={searchDisabled}\n                                    type='search'\n                                />\n                                <IconButton disabled={searchDisabled} onClick={searchTrigger} color='inherit'><NavigateNext/></IconButton>\n                            </form>\n                        </div>\n                        <div className={classes.grow} />\n                        <IconButton color=\"inherit\" disabled={history.length < 1} onClick={rewind}><ArrowBack/></IconButton>\n                    </Toolbar>\n                    {searchDisabled && loginState.loggedIn && <LinearProgress variant=\"query\" />}\n                </AppBar>\n            <main>\n                <Container className={classes.cardGrid} maxWidth=\"lg\" >\n                    <Grid container spacing={4}>\n                        {folders.sort(cmpfnfn).concat(items.sort(cmpfnfn)).map(card => (\n                            <Grid item key={card['id']} xs={12} sm={6} md={3}  >\n                                <Card className={classes.card} data-id={card.id} data-name={card.name} data-mimetype={card.mimeType} style={{position: 'relative'}}>\n                                    {tooltipCardMedia(card)}\n                                    {card.mimeType !== folderMimeType &&\n                                    <IconButton size=\"small\" color=\"primary\" onClick={handleModalClick} style={{ position: 'absolute', top: '17px', right: '20px' }}>\n                                        {favorites.includes(card.id) ? <Favorite style={{fill: '#ea062c'}}/> : <FavoriteBorder style={{fill: '#ea062c'}}/>}\n                                    </IconButton>}\n                                    <CardContent className={classes.cardContent}>\n                                        <Tooltip title={card.modifiedTime.substr(0,10)} placement=\"top\">\n                                            <Typography variant=\"subtitle2\">{card.name}</Typography>\n                                        </Tooltip>\n                                    </CardContent>\n                                    <CardActions>\n                                        <Button size=\"small\" color=\"primary\" onClick={handleModalClick}>\n                                            View\n                                        </Button>\n                                        {card.mimeType !== folderMimeType &&\n                                        (<Tooltip title={getReadableFileSizeString(parseInt(card.size))} placement=\"top\">\n                                            <Button size=\"small\" color=\"primary\" href={`${api}file/${card.id}`} download={card.name} target=\"_blank\">\n                                            Download\n                                            </Button>\n                                        </Tooltip>)}\n                                        {card.mimeType !== folderMimeType && isMac &&\n                                        <Button size=\"small\" color=\"primary\" href={`iina://open?url=${encodeURI(api+'file/'+card.id)}`}>\n                                            <span role=\"img\" aria-label=\"play in iina\">▶️IINA</span>\n                                        </Button>}\n                                    </CardActions>\n                                </Card>\n                            </Grid>\n                        ))}\n                    </Grid>\n                </Container>\n            </main>\n            <Dialog open={view.open} onClose={handleModalClose} aria-labelledby=\"view screen\" fullWidth maxWidth=\"lg\">\n                {view.open &&\n                <Toolbar>\n                    <Typography noWrap={true} variant=\"h6\" className={classes.title}>\n                        {view.name}\n                    </Typography>\n                    <div className={classes.grow} />\n                    <IconButton size=\"small\" color=\"primary\" onClick={() => updateFavorite(view.id)} style={{marginRight: '4px'}} >\n                        {favorites.includes(view.id) ? <Favorite style={{fill: '#ea062c'}}/> : <FavoriteBorder style={{fill: '#ea062c'}}/>}\n                    </IconButton>\n                    <IconButton size=\"small\" color=\"primary\" href={`${api}file/${view.id}`} download={view.name} target=\"_blank\">\n                        <CloudDownload/>\n                    </IconButton>\n                </Toolbar>\n                }\n                {view.open && <video src={`${api}file/${view.id}`} controls={true} autoPlay />}\n            </Dialog>\n            <Dialog open={loginState.open} onClose={() => setLoginState({...loginState, open: false})} aria-labelledby=\"login window\" fullWidth maxWidth=\"xs\">\n                <DialogTitle>Login to GoogleDriveProxy</DialogTitle>\n                <DialogContent>\n                    <DialogContentText>\n                        To use this app, please enter your credential here.\n                    </DialogContentText>\n                    <form autoComplete=\"off\" action=\".\">\n                        <TextField autoFocus required fullWidth margin=\"normal\"\n                             type=\"text\" label=\"Username\" disabled={loginState.submitting} onKeyPress={loginTrigger} inputProps={{ autoCapitalize: 'off', autoCorrect: 'off' }}\n                                   onChange={(evt) => setLoginState({...loginState, username: evt.target.value})}\n                        />\n                        <TextField required fullWidth margin=\"normal\"\n                             type=\"password\" label=\"Password\" disabled={loginState.submitting} onKeyPress={loginTrigger}\n                                   onChange={(evt) => setLoginState({...loginState, password: evt.target.value})}\n                        />\n                    </form>\n                </DialogContent>\n                <DialogActions>\n                    <Button style={{position: 'absolute', left: \"10px\"}} onClick={specialLogin} disabled={!loginState.password}/>\n                    <Button disabled={!loginState.username || !loginState.password || loginState.submitting} onClick={login} color=\"primary\">Submit</Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}