{"version":3,"sources":["index.js"],"names":["api","isMac","navigator","platform","toUpperCase","indexOf","folderMimeType","folderImg","failOverImg","useStyles","makeStyles","theme","appBar","backgroundColor","lightBlue","icon","marginRight","spacing","grow","flexGrow","conditionGrow","Object","_Users_hhuang_WebstormProjects_GoogleDriveProxy_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_5__","breakpoints","up","search","position","borderRadius","shape","fade","palette","common","white","&:hover","marginLeft","width","searchIcon","height","pointerEvents","display","alignItems","justifyContent","inputRoot","color","inputInput","padding","transition","transitions","create","cardGrid","paddingTop","paddingBottom","card","flexDirection","cardMedia","cardContent","form","flexWrap","formControl","margin","minWidth","viewed","id","recentViews","JSON","parse","localStorage","getItem","splice","unshift","setItem","stringify","getReadableFileSizeString","fileSizeInBytes","i","Math","max","toFixed","getToken","cacheItems","ReactDOM","render","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","classes","inputRef","React","createRef","_React$useState","useState","loggedIn","open","submitting","_React$useState2","_Users_hhuang_WebstormProjects_GoogleDriveProxy_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_4__","loginState","setLoginState","_React$useState3","_React$useState4","searchDisabled","setSearchDisabled","_React$useState5","_React$useState6","items","setItems","_React$useState7","_React$useState8","folders","setFolders","_React$useState9","_React$useState10","history","setHistory","_React$useState11","_React$useState12","favorites","setFavorites","_React$useState13","key","reverse","disabled","_React$useState14","orderby","setOrderby","_React$useState15","_React$useState16","view","setView","cmpfnfn","b","c","k","localeCompare","parseInt","loadResource","opts","rewind","value","length","slice","fetch","concat","_Users_hhuang_WebstormProjects_GoogleDriveProxy_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__","headers","Authorization","then","resp","json","res","sort","files","filter","el","mimeType","_Users_hhuang_WebstormProjects_GoogleDriveProxy_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__","postProcess","catch","alert","finally","searchTrigger","ev","preventDefault","current","accessModal","state","name","item","find","x","body","method","Content-Type","console","log","loginTrigger","username","password","login","status","token","afterLogin","err","useEffect","eventResponder","window","location","hash","substr","addEventListener","fetchFavorite","isAdd","includes","_ref","_Users_hhuang_WebstormProjects_GoogleDriveProxy_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_Users_hhuang_WebstormProjects_GoogleDriveProxy_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","mark","_callee","wrap","_context","prev","next","sent","errorMessage","stop","_x","apply","this","arguments","handleMenuClose","handleModalClick","e","mimetype","target","parentNode","attributes","getNamedItem","tagName","replaceState","dispatchEvent","Event","_React$useState17","_React$useState18","anchorEl","setAnchorEl","Fragment","_material_ui_core_CssBaseline__WEBPACK_IMPORTED_MODULE_9__","_material_ui_core_AppBar__WEBPACK_IMPORTED_MODULE_10__","className","_material_ui_core_Toolbar__WEBPACK_IMPORTED_MODULE_11__","_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_34__","aria-controls","aria-haspopup","onClick","event","currentTarget","_material_ui_icons__WEBPACK_IMPORTED_MODULE_12__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_25__","variant","_material_ui_core_Menu__WEBPACK_IMPORTED_MODULE_19__","keepMounted","Boolean","onClose","_material_ui_core_MenuItem__WEBPACK_IMPORTED_MODULE_35__","r","map","innerText","autoComplete","_material_ui_core_FormControl__WEBPACK_IMPORTED_MODULE_36__","_material_ui_core_InputLabel__WEBPACK_IMPORTED_MODULE_37__","htmlFor","_material_ui_core_Select__WEBPACK_IMPORTED_MODULE_38__","onChange","inputProps","removeItem","_material_ui_icons__WEBPACK_IMPORTED_MODULE_13__","action","onSubmit","_material_ui_core_InputBase__WEBPACK_IMPORTED_MODULE_24__","placeholder","root","input","aria-label","type","_material_ui_icons__WEBPACK_IMPORTED_MODULE_14__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_15__","_material_ui_core_LinearProgress__WEBPACK_IMPORTED_MODULE_33__","_material_ui_core_Container__WEBPACK_IMPORTED_MODULE_28__","maxWidth","_material_ui_core_Grid__WEBPACK_IMPORTED_MODULE_27__","container","xs","sm","md","_material_ui_core_Card__WEBPACK_IMPORTED_MODULE_29__","data-id","data-name","data-mimetype","style","time","modifiedTime","size","_material_ui_core_Tooltip__WEBPACK_IMPORTED_MODULE_39__","title","_material_ui_core_CardMedia__WEBPACK_IMPORTED_MODULE_30__","image","thumbnailLink","tooltipCardMedia","top","right","_material_ui_icons__WEBPACK_IMPORTED_MODULE_16__","fill","_material_ui_icons__WEBPACK_IMPORTED_MODULE_17__","_material_ui_core_CardContent__WEBPACK_IMPORTED_MODULE_31__","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_20__","component","_material_ui_core_CardActions__WEBPACK_IMPORTED_MODULE_32__","placement","href","download","encodeURI","role","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_26__","pathname","aria-labelledby","fullWidth","noWrap","_material_ui_icons__WEBPACK_IMPORTED_MODULE_18__","src","controls","autoPlay","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_40__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_42__","_material_ui_core_DialogContentText__WEBPACK_IMPORTED_MODULE_41__","_material_ui_core_TextField__WEBPACK_IMPORTED_MODULE_43__","autoFocus","required","label","onKeyPress","evt","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_44__","document","getElementById"],"mappings":"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","file":"static/js/main.bf3d5c7d.chunk.js","sourcesContent":["import React, {useEffect} from 'react';\nimport ReactDOM from 'react-dom';\n// import { render } from 'react-snapshot';\nimport './index.css';\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport {Menu as MenuIcon, Search, ArrowBack, NavigateNext, CloudDownload, FavoriteBorder, Favorite} from '@material-ui/icons';\nimport Menu from '@material-ui/core/Menu';\nimport Typography from \"@material-ui/core/Typography\";\nimport {makeStyles} from \"@material-ui/core\";\nimport {lightBlue} from \"@material-ui/core/colors\";\nimport {fade} from \"@material-ui/core/styles\";\nimport InputBase from \"@material-ui/core/InputBase\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Container from \"@material-ui/core/Container\";\nimport Card from \"@material-ui/core/Card\";\nimport CardMedia from \"@material-ui/core/CardMedia\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport Select from \"@material-ui/core/Select\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport TextField from \"@material-ui/core/TextField\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\n\nconst api = \"https://api.sheltonhuang.me/GoogleDriveProxy/\";\n\nconst isMac = navigator.platform.toUpperCase().indexOf('MAC')>=0;\nconst folderMimeType = 'application/vnd.google-apps.folder';\nconst folderImg = 'folderImg.jpg';\nconst failOverImg = 'imgNotFound.jpg';\n\nconst useStyles = makeStyles(theme => ({\n    appBar: {\n        backgroundColor: lightBlue[\"700\"],\n    },\n    icon: {\n        marginRight: theme.spacing(2),\n    },\n    grow: {\n        flexGrow: 1,\n    },\n    conditionGrow: {\n        [theme.breakpoints.up('sm')]: {\n            flexGrow: 1,\n        }\n    },\n    search: {\n        position: 'relative',\n        borderRadius: theme.shape.borderRadius,\n        backgroundColor: fade(theme.palette.common.white, 0.15),\n        '&:hover': {\n            backgroundColor: fade(theme.palette.common.white, 0.25),\n        },\n        marginRight: 0,\n        marginLeft: 0,\n        width: '100%',\n        [theme.breakpoints.up('sm')]: {\n            width: 600,\n        },\n    },\n    searchIcon: {\n        width: theme.spacing(7),\n        height: '100%',\n        position: 'absolute',\n        pointerEvents: 'none',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n    },\n    inputRoot: {\n        color: 'inherit',\n        width: 'calc(100% - 50px)'\n    },\n    inputInput: {\n        padding: theme.spacing(1, 1, 1, 7),\n        transition: theme.transitions.create('width'),\n        width: '100%'\n    },\n    cardGrid: {\n        paddingTop: theme.spacing(8),\n        paddingBottom: theme.spacing(8),\n    },\n    card: {\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'column',\n    },\n    cardMedia: {\n        paddingTop: '56.25%', // 16:9\n    },\n    cardContent: {\n        flexGrow: 1,\n    },\n    form: {\n        display: 'flex',\n        flexWrap: 'wrap'\n    },\n    formControl: {\n        margin: theme.spacing(1),\n        minWidth: 120,\n    }\n}));\n\n\n\nconst viewed = (id) => {\n    let recentViews = JSON.parse(localStorage.getItem(\"recentViews\") || \"[]\");\n    let position = recentViews.indexOf(id);\n    if (position > -1) recentViews.splice(position, 1);\n    recentViews.unshift(id);\n    recentViews.splice(100);\n    localStorage.setItem(\"recentViews\", JSON.stringify(recentViews));\n};\n\nfunction getReadableFileSizeString(fileSizeInBytes) {\n    let i = -1, byteUnits = [' kB', ' MB', ' GB', ' TB', 'PB', 'EB', 'ZB', 'YB'];\n    do { fileSizeInBytes = fileSizeInBytes / 1024; i++; } while (fileSizeInBytes > 1024);\n    return Math.max(fileSizeInBytes, 0.1).toFixed(1) + byteUnits[i];\n}\n\nconst getToken = ()=> localStorage.getItem(\"token\");\nlet cacheItems = [];\n\nfunction App() {\n    const classes = useStyles();\n    const inputRef = React.createRef();\n\n    const [loginState, setLoginState]  = React.useState({loggedIn: !!getToken(), open: false, submitting: false});\n    const [searchDisabled, setSearchDisabled] = React.useState(!getToken());\n    const [items, setItems] = React.useState([]);\n    const [folders, setFolders] = React.useState([]);\n    const [history, setHistory] = React.useState([]);\n    const [favorites, setFavorites] = React.useState([]);\n    const [orderby, setOrderby] = React.useState({key: 'modifiedTime', reverse:true, disabled: false});\n    const [view, setView] = React.useState({open: false});\n\n\n    const cmpfnfn = (a,b) => {\n        if (orderby.disabled) return 0;\n        if (orderby.reverse)  { let c = a; a = b; b = c; }\n        let k = orderby.key;\n        if (k === 'name' || k === 'modifiedTime') { return a[k].localeCompare(b[k]) }\n        else { return (a[k] && b[k]) ? parseInt(a[k]) - parseInt(b[k]) : a['modifiedTime'].localeCompare(b['modifiedTime']) }\n    };\n\n    const loadResource = (opts) => {\n        setSearchDisabled(true);\n        if (opts.rewind) {\n            opts.value = history[history.length-2];\n            setHistory(history.slice(0, history.length-1));\n        }\n        return fetch(`${api}${opts.value}`,  {headers: {Authorization: getToken()}, ...(opts.opts ? opts.opts : {})})\n            .then(resp => resp.json())\n            .then((res) => {\n                setOrderby({...orderby, disabled: opts.sort === false});\n                setItems(cacheItems = res.files.filter(el => el.mimeType !== folderMimeType));\n                setFolders(res.files.filter(el => el.mimeType === folderMimeType));\n                !opts.rewind && !opts.opts && (!history.length || history[history.length-1] !== opts.value) && setHistory([...history, opts.value]);\n                return res;\n            })\n            .then((res) => opts.postProcess ? opts.postProcess(res) : null)\n            .catch(alert)\n            .finally(() => setSearchDisabled(false));\n    };\n\n    const searchTrigger = (ev) => {\n        ev && ev.preventDefault && ev.preventDefault();\n        loadResource({value: inputRef.current.value ? `query/${inputRef.current.value}` : 'folder/root'});\n    };\n\n\n\n\n    const accessModal = (state) => {\n        if (state.name) {\n            setView(state);\n        } else {\n            let item = cacheItems.find(x => x.id === state.id);\n            if (item) {\n                setView({...state, name: item.name});\n                viewed(state.id);\n            } else {\n                fetch(`${api}file`, {\n                        body: JSON.stringify({files: [state.id]}),\n                        method: 'POST',\n                        headers: {'Authorization': getToken(), 'Content-Type': 'application/json'}\n                    })\n                    .then(resp => resp.json())\n                    .then(res => {\n                        if (res.files.length === 1) {\n                            setView({...state, name: res.files[0].name});\n                            viewed(state.id);\n                        }\n                    })\n                    .catch(console.log);\n            }\n        }\n    };\n\n    const loginTrigger = (ev) => {\n        if (ev.key === 'Enter' && loginState.username && loginState.password) login();\n    };\n\n    const login = () => {\n        setLoginState({...loginState, submitting: true});\n        fetch(`${api}auth`, {\n            body: JSON.stringify({username: loginState.username, password: loginState.password}),\n            method: 'POST',\n            headers: {'Content-Type': 'application/json'}\n        })\n            .then(resp => {\n                if (resp.status === 401) {\n                    alert(\"Incorrect username or password.\");\n                    throw resp;\n                } else if (resp.status === 200) {\n                    return resp.json();\n                } else {\n                    alert(\"Unknown response \" + resp.status + \" from server.\");\n                    throw resp;\n                }\n            })\n            .then(resp => {\n                localStorage.setItem('token', resp.token);\n                afterLogin();\n                setLoginState({loggedIn: true, open: false, submitting: false});\n            })\n            .catch(err => {\n                console.log(err);\n                setLoginState({...loginState, submitting: false});\n            })\n    };\n\n    const logout = () => {\n        inputRef.current.value = \"\";\n        setLoginState({loggedIn: false, open: false, submitting: false});\n        setItems([]); setFolders([]); setFavorites([]); setHistory([]); setSearchDisabled(true);\n        localStorage.removeItem('token');\n        handleMenuClose();\n    };\n\n    const afterLogin = () => {\n        loadResource({value: 'folder/root'});\n        fetch(`${api}favorite`, {headers: {Authorization: getToken()}})\n            .then(resp => resp.json())\n            .then((res) => setFavorites(res.files))\n            .catch(alert);\n    };\n\n    useEffect(() => {\n        const eventResponder = () =>  accessModal({open: true, id: window.location.hash.substr(1)});\n        window.addEventListener(\"hashchange\", eventResponder, false);\n        window.addEventListener(\"myhashchange\", eventResponder, false);\n        if (window.location.hash.substr(1)) accessModal({open: true, id: window.location.hash.substr(1)});\n       if (getToken()) afterLogin();\n    // eslint-disable-next-line\n    }, []);\n\n\n    //modal\n\n    const fetchFavorite = (id) => {\n        let isAdd = !favorites.includes(id);\n        fetch(`${api}favorite/${id}`, {headers: {Authorization: getToken()}, method: isAdd ? 'PUT' : 'DELETE'})\n            .then(async resp => {\n                if (resp.status === 204)  {\n                    if (isAdd) {\n                        if (!favorites.includes(id)) {\n                            setFavorites([id, ...favorites])\n                        }\n                    } else {\n                        setFavorites(favorites.filter(x => x !== id));\n                    }\n                } else if (resp.status === 507) {\n                    throw (await resp.json()).errorMessage;\n                } else {\n                    throw resp.json();\n                }\n            })\n            .catch(alert)\n            .finally(handleMenuClose);\n    };\n\n    const fetchRecent = () => {\n        let recentViews = JSON.parse(localStorage.getItem(\"recentViews\") || \"[]\");\n        if (recentViews.length) {\n            loadResource({\n                sort: false,\n                value: \"file\",\n                opts: {\n                    body: JSON.stringify({files: recentViews}),\n                    method: 'POST',\n                }}).then(handleMenuClose)\n        }\n    };\n\n    const changeReverse = (e) => {\n        if (e.target.innerText && e.target.innerText.includes('Order By')) {\n            setOrderby({...orderby, reverse: !orderby.reverse})\n        }\n    };\n\n    const handleModalClick = (e) => {\n        let el = e.target, id, name, mimetype;\n        do {\n            el = el.parentNode;\n            id = el.attributes.getNamedItem('data-id') ? el.attributes.getNamedItem('data-id').value : null;\n            name = el.attributes.getNamedItem('data-name') ? el.attributes.getNamedItem('data-name').value : null;\n            mimetype = el.attributes.getNamedItem('data-mimetype') ? el.attributes.getNamedItem('data-mimetype').value : null;\n        } while (el.parentNode && !(id && name && mimetype));\n\n        if (e.target.tagName === 'svg' || e.target.tagName === 'path') {  // is favorite click\n            fetchFavorite(id);\n        } else {\n            if (mimetype === folderMimeType) {\n                loadResource({value: `folder/${id}`});\n            } else {\n                window.history.replaceState({}, '', '#' + id);\n                window.dispatchEvent(new Event(\"myhashchange\"));\n            }\n        }\n    };\n\n    const handleModalClose = () => {\n        setView({open: false});\n        window.history.replaceState({}, '', window.location.pathname);\n    };\n\n\n    //menu\n    const [anchorEl, setAnchorEl] = React.useState(null);\n\n    const handleMenuClick = (event) => setAnchorEl(event.currentTarget);\n\n    const handleMenuClose = () => setAnchorEl(null);\n\n\n    function tooltipCardMedia(card) {\n        let time = card.modifiedTime;\n        let size = card.size;\n        if (time && size) {\n            return  (\n                <Tooltip title={<div>{getReadableFileSizeString(parseInt(size))}<br />{time.substr(0,10)}</div>}>\n                    <CardMedia className={classes.cardMedia} onClick={handleModalClick} style={{height: 0}}\n                    image={card.mimeType === folderMimeType ? folderImg : (card.thumbnailLink || failOverImg)} />\n                </Tooltip>);\n        } else {\n            return (\n                <CardMedia className={classes.cardMedia} title={card.name} onClick={handleModalClick}\n                    image={card.mimeType === folderMimeType ? folderImg : (card.thumbnailLink || failOverImg)} />);\n        }\n    }\n\n\n    return (\n        <>\n            <CssBaseline />\n                <AppBar position=\"sticky\" className={classes.appBar}>\n                    <Toolbar>\n                        {loginState.loggedIn ?\n                            (<IconButton color=\"inherit\" aria-controls=\"simple-menu\" aria-haspopup=\"true\" onClick={handleMenuClick}><MenuIcon/></IconButton>) :\n                            ( <Button  variant=\"contained\"  onClick={() => setLoginState({...loginState, open: true})} >Login</Button>)\n                        }\n                        <Menu\n                            id=\"simple-menu\" keepMounted\n                            anchorEl={anchorEl}\n                            open={Boolean(anchorEl)}\n                            onClose={handleMenuClose}\n                        >\n                            <MenuItem onClick={() => loadResource({value: \"folder/root\"})} >Home</MenuItem>\n                            <MenuItem onClick={() => loadResource({\n                                value: \"favorite?alt=content\",\n                                postProcess: (r) => setFavorites(r.files.map(x => x.id)) })} >Favorites</MenuItem>\n                            <MenuItem onClick={changeReverse}>\n                                <form className={classes.form} autoComplete=\"off\">\n                                    <FormControl className={classes.formControl}>\n                                        <InputLabel htmlFor=\"orderby\">Order By{orderby.reverse ? ' ⬇️':' ⬆️'}</InputLabel>\n                                        <Select\n                                            value={orderby.key}\n                                            onChange={(event) => setOrderby({...orderby, key: event.target.value})}\n                                            inputProps={{ name: 'Order By', id: 'orderby', }}\n                                        >\n                                            <MenuItem value={'modifiedTime'}>Last Modified</MenuItem>\n                                            <MenuItem value={'name'}>Name</MenuItem>\n                                            <MenuItem value={'size'}>Size</MenuItem>\n                                        </Select>\n                                    </FormControl>\n                                </form>\n                            </MenuItem>\n                            <MenuItem onClick={fetchRecent} >Recently Viewed</MenuItem>\n                            <MenuItem onClick={logout} >Logout</MenuItem>\n                        </Menu>\n\n                        <div className={classes.grow} />\n                        <div className={classes.search}>\n                            <div className={classes.searchIcon}>\n                                <Search />\n                            </div>\n                            <form action=\".\" onSubmit={searchTrigger}>\n                                <InputBase\n                                    placeholder=\"Search…\"\n                                    classes={{\n                                        root: classes.inputRoot,\n                                        input: classes.inputInput,\n                                    }}\n                                    inputProps={{ 'aria-label': 'Search keywords' }}\n                                    inputRef={inputRef}\n                                    disabled={searchDisabled}\n                                    type='search'\n                                />\n                                <IconButton disabled={searchDisabled} onClick={searchTrigger} color='inherit'><NavigateNext/></IconButton>\n                            </form>\n                        </div>\n                        <div className={classes.grow} />\n                        <IconButton color=\"inherit\" disabled={history.length <= 1} onClick={() => loadResource({rewind: true})}><ArrowBack/></IconButton>\n                    </Toolbar>\n                    {searchDisabled && loginState.loggedIn && <LinearProgress variant=\"query\" />}\n                </AppBar>\n            <main>\n                <Container className={classes.cardGrid} maxWidth=\"lg\" >\n                    <Grid container spacing={4}>\n                        {folders.sort(cmpfnfn).concat(items.sort(cmpfnfn)).map(card => (\n                            <Grid item key={card['id']} xs={12} sm={6} md={3}  >\n                                <Card className={classes.card} data-id={card.id} data-name={card.name} data-mimetype={card.mimeType} style={{position: 'relative'}}>\n                                    {tooltipCardMedia(card)}\n                                    {card.mimeType !== folderMimeType &&\n                                    <IconButton size=\"small\" color=\"primary\" onClick={handleModalClick} style={{ position: 'absolute', top: '17px', right: '20px' }}>\n                                        {favorites.includes(card.id) ? <Favorite style={{fill: '#ea062c'}}/> : <FavoriteBorder style={{fill: '#ea062c'}}/>}\n                                    </IconButton>}\n                                    <CardContent className={classes.cardContent}>\n                                        <Typography variant=\"subtitle1\" component=\"h2\">\n                                            {card.name}\n                                        </Typography>\n                                    </CardContent>\n                                    <CardActions>\n                                        <Button size=\"small\" color=\"primary\" onClick={handleModalClick}>\n                                            View\n                                        </Button>\n                                        {card.mimeType !== folderMimeType &&\n                                        (<Tooltip title={getReadableFileSizeString(parseInt(card.size))} placement=\"top\">\n                                            <Button size=\"small\" color=\"primary\" href={`${api}file/${card.id}`} download={card.name} target=\"_blank\">\n                                            Download\n                                            </Button>\n                                        </Tooltip>)}\n                                        {card.mimeType !== folderMimeType && isMac &&\n                                        <Button size=\"small\" color=\"primary\" href={`iina://open?url=${encodeURI(api+'file/'+card.id)}`}>\n                                            <span role=\"img\" aria-label=\"play in iina\">▶️IINA</span>\n                                        </Button>}\n                                    </CardActions>\n                                </Card>\n                            </Grid>\n                        ))}\n                    </Grid>\n                </Container>\n            </main>\n            <Dialog open={view.open} onClose={handleModalClose} aria-labelledby=\"view screen\" fullWidth maxWidth=\"lg\">\n                {view.open &&\n                <Toolbar>\n                    <Typography noWrap={true} variant=\"h6\" className={classes.title}>\n                        {view.name}\n                    </Typography>\n                    <div className={classes.grow} />\n                    <IconButton size=\"small\" color=\"primary\" onClick={() => fetchFavorite(view.id)} style={{marginRight: '4px'}} >\n                        {favorites.includes(view.id) ? <Favorite style={{fill: '#ea062c'}}/> : <FavoriteBorder style={{fill: '#ea062c'}}/>}\n                    </IconButton>\n                    <IconButton size=\"small\" color=\"primary\" href={`${api}file/${view.id}`} download={view.name} target=\"_blank\">\n                        <CloudDownload/>\n                    </IconButton>\n                </Toolbar>\n                }\n                {view.open && <video src={`${api}file/${view.id}`} controls={true} autoPlay />}\n            </Dialog>\n            <Dialog open={loginState.open} onClose={() => setLoginState({...loginState, open: false})} aria-labelledby=\"login window\" fullWidth maxWidth=\"xs\">\n                <DialogTitle>Login to GoogleDriveProxy</DialogTitle>\n                <DialogContent>\n                    <DialogContentText>\n                        To use this app, please enter your credential here.\n                    </DialogContentText>\n                    <form autoComplete=\"off\" action=\".\">\n                        <TextField autoFocus required fullWidth margin=\"normal\"\n                             type=\"text\" label=\"Username\" disabled={loginState.submitting} onKeyPress={loginTrigger}\n                                   onChange={(evt) => setLoginState({...loginState, username: evt.target.value})}\n                        />\n                        <TextField autoFocus required fullWidth margin=\"normal\"\n                             type=\"password\" label=\"Password\" disabled={loginState.submitting} onKeyPress={loginTrigger}\n                                   onChange={(evt) => setLoginState({...loginState, password: evt.target.value})}\n                        />\n                    </form>\n                </DialogContent>\n                <DialogActions>\n                    <Button disabled={!loginState.username || !loginState.password || loginState.submitting} onClick={login} color=\"primary\">Submit</Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}